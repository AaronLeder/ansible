---
- name: "Optionally ensure source VM is started (run once)"
  when: proxmox_ensure_source_started | default(false) | bool
  run_once: true
  delegate_to: localhost
  community.proxmox.proxmox_kvm:
    api_host: "{{ proxmox_api_host }}"
    api_port: "{{ proxmox_api_port | default(8006) }}"
    api_user: "{{ proxmox_api_user }}"
    api_token_id: "{{ proxmox_api_token_id }}"
    api_token_secret: "{{ proxmox_api_token_secret }}"
    validate_certs: "{{ proxmox_validate_certs | default(false) }}"
    node: "{{ proxmox_node }}"
    name: "{{ proxmox_source_vm_name }}"
    state: started